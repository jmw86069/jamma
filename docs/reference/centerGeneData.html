<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Center gene data — centerGeneData • jamma</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Center gene data — centerGeneData"><meta property="og:description" content="Performs per-row centering on a numeric matrix"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamma</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.33.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jamma-vignette.html">Introduction to jamma</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jmw86069/jamma/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Center gene data</h1>
    <small class="dont-index">Source: <a href="https://github.com/jmw86069/jamma/blob/HEAD/R/jamma-center.R" class="external-link"><code>R/jamma-center.R</code></a></small>
    <div class="hidden name"><code>centerGeneData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs per-row centering on a numeric matrix</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">centerGeneData</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  centerGroups <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  controlSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  useMedian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rmOutliers <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  madFactor <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  controlFloor <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  naControlAction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"row"</span>, <span class="st">"floor"</span>, <span class="st">"min"</span><span class="op">)</span>,</span>
<span>  naControlFloor <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rowStatsFunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  returnGroupedValues <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  returnGroups <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code>numeric</code> matrix of input data. See assumptions,
that data is assumed to be log2-transformed, or otherwise
appropriately transformed.</p></dd>


<dt>centerGroups</dt>
<dd><p><code>character</code> vector of group names, or
<code>NULL</code> if there are no groups.</p></dd>


<dt>na.rm</dt>
<dd><p><code>logical</code> indicating whether NA values should be
ignored for summary statistics. This argument is passed
to the corresponding row stats function. Frankly, this
value should be <code>na.rm=TRUE</code> for all stat functions by default,
for example <code>mean(..., na.rm=TRUE)</code> should be default.</p></dd>


<dt>controlSamples</dt>
<dd><p><code>character</code> vector of values in <code>colnames(x)</code>
which defines the columns to use when calculating group
summary values.</p></dd>


<dt>useMedian</dt>
<dd><p><code>logical</code> indicating whether to use group median
values when calculating summary statistics <code>TRUE</code>, or
group means <code>FALSE</code>. In either case, when <code>rowStatsFunc</code>
is provided, it is used instead.</p></dd>


<dt>rmOutliers</dt>
<dd><p><code>logical</code> indicating whether to perform outlier
detection and removal prior to row group stats. This
argument is passed to <code><a href="https://rdrr.io/pkg/jamba/man/rowGroupMeans.html" class="external-link">jamba::rowGroupMeans()</a></code>. Note that
outliers are only removed during the row group summary step,
and not in the centered data.</p></dd>


<dt>madFactor</dt>
<dd><p><code>numeric</code> value passed to <code><a href="https://rdrr.io/pkg/jamba/man/rowGroupMeans.html" class="external-link">jamba::rowGroupMeans()</a></code>,
indicating the MAD factor threshold to use when <code>rmOutliers=TRUE</code>.
The MAD of each row group is computed, the overall group median
MAD is used to define 1x MAD factor, and any MAD more than
<code>madFactor</code> times the group median MAD is considered an outlier
and is removed. The remaining data is used to compute row
group values.</p></dd>


<dt>controlFloor</dt>
<dd><p><code>numeric</code> value used as a minimum for any control
summary value during centering.
Use <code>NA</code> to skip this behavior.
When defined, all control group summary values are calculated,
then any values below <code>controlFloor</code> are set to the <code>controlFloor</code>
for the purpose of data centering.
By default <code>controlFloor=NA</code> which imposes no such floor value.
However, <code>controlFloor=0</code> would be appropriate when zero is defined
as effective noise floor after something like background subtraction
during the upstream processing or upstream normalization.
Using a value above zero would be appropriate when the effective
noise floor of a platform is above zero, so that values are not
centered relative to noise. For example, if the effective noise
floor is 5, then centering should not "amplify" differences from
any value less than 5, since in this scenario a value of 5 or less
is effectively the same as a value of 5. It has the effect of returning
fold changes relative to the effective platform minimum detectable
signal.</p></dd>


<dt>naControlAction</dt>
<dd><p><code>character</code> string indicating how to handle the specific
scenario when the control group summary value is <code>NA</code> for a particular
centering operation.</p><ul><li><p><code>"na"</code>: default is to return <code>NA</code> since 15 - NA = NA.</p></li>
<li><p><code>"row"</code>: use the summary value across all relevant samples,
so the centering is against all non-NA values within the center group.</p></li>
<li><p><code>"floor"</code>: use the numeric value defined by <code>naControlFloor</code>,
to indicate a practical noise floor for the centering operation.
When <code>naControlFloor=0</code> (default) this option effectively keeps
non-NA values without centering these values.</p></li>
<li><p><code>"min"</code>: use the minimum control value as the floor, which effectively
defines the floor by the lowest observed summary value across all
rows. It assumes rows are generally on the same range of detection,
even if not all rows have the same observed range. For example,
microarray probes have reasonably similar theoretical range of
detection, even if some probes to highly-expressed genes are
commonly observed with higher signal. The lowest observed signal
effectively sets the minimum detected value.</p></li>
</ul></dd>


<dt>rowStatsFunc</dt>
<dd><p><code>optional</code> function used to calculate row group
summary values. This function should take a numeric matrix as
input, and return a one-column numeric matrix as output, or
a numeric vector with length <code>nrow(x)</code>. The function should
also accept <code>na.rm</code> as an argument.</p></dd>


<dt>returnGroupedValues</dt>
<dd><p><code>logical</code> indicating whether to include
the numeric matrix of row group values used during centering,
returned in the attributes with name <code>"x_group"</code>.</p></dd>


<dt>returnGroups</dt>
<dd><p><code>logical</code> indicating whether to return the
centering summary data.frame in attributes with name "center_df".</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are passed to <code><a href="https://rdrr.io/pkg/jamba/man/rowGroupMeans.html" class="external-link">jamba::rowGroupMeans()</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function centers data by subtracting the median or
mean for each row.</p>
<p>Columns can be grouped using argument <code>centerGroups</code>.
Each group group of columns defined by <code>centerGroups</code>
is centered independently.</p>
<p>Data can be centered relative to specific control columns
using argument <code>controlSamples</code>.
When <code>controlSamples</code> is not supplied, the default behavior
is to use all columns. This process is consistent with
typical MA-plots.</p>
<p>It may be preferred to define <code>controlSamples</code> in cases where
there are known reference samples, against which other samples
should be compared.</p>
<p>The <code>controlSamples</code> logic is applied independently to each
group defined in <code>centerGroups</code>.</p>
<p>You can confirm the <code>centerGroups</code> and <code>controlSamples</code> are
correct in the result data, by accessing the attribute
<code>"center_df"</code>, see examples below.</p>
<p>Note: This function assumes input data is suitable for
centering by subtraction.
This data requirement is true for:</p><ul><li><p>most log-transformed gene expression data</p></li>
<li><p>quantitative PCR (QPCR) cycle threshold (CT) values</p></li>
<li><p>other numeric data that has been suitably transformed
to meet reasonable parametric assumption of normality,</p></li>
<li><p>rank-transformed data which results in difference in rank</p></li>
<li><p>generally speaking, any data where the difference between 5 and 7 (2)
is reasonably similar to the difference between 15 and 17 (2).</p></li>
<li><p>it may be feasible to perform background subtraction on straight
count data, for example sequence coverage at a particular location
in a genome.</p></li>
</ul><p>The data requirement is not true for:</p><ul><li><p>most gene expression data in normal space
(hint: if any value is above 100, it is generally not log-transformed)</p></li>
<li><p>numeric data that is strongly skewed</p></li>
<li><p>generally speaking, any data where the difference between 5 and 7
is not reasonably similar to the difference between 15 and 17. If
the percent difference is more likely to be the interesting measure,
data may be log-transformed for analysis.</p></li>
</ul><p>For special cases, <code>rowStatsFunc</code> can be supplied to perform
specific group summary calculations per row.</p><div class="section">
<h3 id="control-groups-with-na-values-since-version-">Control groups with NA values (since version 0.0.28.900)<a class="anchor" aria-label="anchor" href="#control-groups-with-na-values-since-version-"></a></h3>


<p>When <code>controlSamples</code> is supplied, and contains all <code>NA</code> values
for a given row of data, within relevant <code>centerGroups</code> subsets,
the default behavior is defined by <code>naControlAction="NA"</code> below:</p><ol><li><p><code>naControlAction="na"</code>: values are centered versus <code>NA</code> which
results in all values <code>NA</code> (current behavior, default).</p></li>
<li><p><code>naControlAction="row"</code>: values are centered versus the row,
using all samples in the same center group. This action effectively
"centers to what we have".</p></li>
<li><p><code>naControlAction="floor"</code>: values are centered versus a <code>numeric</code>
floor defined by argument <code>naControlFloor</code>. When <code>naControlFloor=0</code>
then values are effectively not centered. However, <code>naControlFloor=10</code>
could for example be used to center values versus a practical noise
floor, if the range of detection for a particular experiment starts
at 10 as a low value.</p></li>
<li><p><code>naControlAction="min"</code>: values are centered versus the minimum
observed summary value in the data, which effectively uses the data
to define a value for <code>naControlFloor</code>.</p></li>
</ol><p>The motivation to center versus something other than <code>controlSamples</code>
when all measurements for <code>controlSamples</code> are <code>NA</code> is to have
a <code>numeric</code> value to indicate that a measurement was detected in
non-control columns. This situation occurs in technologies when
control samples have very low signal, and in some cases report
<code>NA</code> when no measurement is detected within the instrument range
of detection.</p>
</div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam matrix functions: 
<code><a href="jammacalc.html">jammacalc</a>()</code>,
<code><a href="jammanorm.html">jammanorm</a>()</code>,
<code><a href="matrix_to_column_rank.html">matrix_to_column_rank</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, ncol<span class="op">=</span><span class="fl">10</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="co"># basic centering</span></span></span>
<span class="r-in"><span><span class="fu">centerGeneData</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a   b   c   d  e f  g  h  i  j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -45 -35 -25 -15 -5 5 15 25 35 45</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># grouped centering</span></span></span>
<span class="r-in"><span><span class="fu">centerGeneData</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>   centerGroups<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a   b c  d  e   f   g h  i  j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -20 -10 0 10 20 -20 -10 0 10 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># centering versus specific control columns</span></span></span>
<span class="r-in"><span><span class="fu">centerGeneData</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a b  c  d  e  f  g  h  i  j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -10 0 10 20 30 40 50 60 70 80</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># grouped centering versus specific control columns</span></span></span>
<span class="r-in"><span><span class="fu">centerGeneData</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>   centerGroups<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         a b  c  d  e   f g  h  i  j</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -10 0 10 20 30 -10 0 10 20 30</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># confirm the centerGroups and controlSamples</span></span></span>
<span class="r-in"><span><span class="va">x_ctr</span> <span class="op">&lt;-</span> <span class="fu">centerGeneData</span><span class="op">(</span><span class="va">x</span>,</span></span>
<span class="r-in"><span>   centerGroups<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>   returnGroups<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">x_ctr</span>, <span class="st">"center_df"</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sample centerGroups controlSamples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> a      a            A           TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> b      b            A           TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c      c            A           TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> d      d            A          FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e      e            A          FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> f      f            B           TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> g      g            B           TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> h      h            B           TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> i      i            B          FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> j      j            B          FALSE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

