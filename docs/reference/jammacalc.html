<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate MA-plot data — jammacalc • jamma</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate MA-plot data — jammacalc" />
<meta property="og:description" content="Calculate MA-plot data" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamma</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.18.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jamma-vignette.html">Introduction to jamma</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jmw86069/jamma/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate MA-plot data</h1>
    <small class="dont-index">Source: <a href='https://github.com/jmw86069/jamma/blob/master/R/jamma.r'><code>R/jamma.r</code></a></small>
    <div class="hidden name"><code>jammacalc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate MA-plot data</p>
    </div>

    <pre class="usage"><span class='fu'>jammacalc</span><span class='op'>(</span>
  <span class='va'>x</span>,
  na.rm <span class='op'>=</span> <span class='cn'>TRUE</span>,
  controlSamples <span class='op'>=</span> <span class='cn'>NULL</span>,
  centerGroups <span class='op'>=</span> <span class='cn'>NULL</span>,
  groupedX <span class='op'>=</span> <span class='cn'>TRUE</span>,
  useMedian <span class='op'>=</span> <span class='cn'>TRUE</span>,
  useMean <span class='op'>=</span> <span class='cn'>NULL</span>,
  whichSamples <span class='op'>=</span> <span class='cn'>NULL</span>,
  noise_floor <span class='op'>=</span> <span class='op'>-</span><span class='cn'>Inf</span>,
  noise_floor_value <span class='op'>=</span> <span class='va'>noise_floor</span>,
  naValue <span class='op'>=</span> <span class='cn'>NA</span>,
  mad_row_min <span class='op'>=</span> <span class='fl'>0</span>,
  grouped_mad <span class='op'>=</span> <span class='cn'>TRUE</span>,
  centerFunc <span class='op'>=</span> <span class='va'>centerGeneData</span>,
  useRank <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnType <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ma_list"</span>, <span class='st'>"tidy"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>numeric matrix typically containing log-normal measurements,
with measurement rows, and sample columns.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>logical indicating whether to ignore NA values
during numeric summary functions.</p></td>
    </tr>
    <tr>
      <th>controlSamples</th>
      <td><p>character vector containing values in
<code><a href='https://rdrr.io/r/base/colnames.html'>colnames(x)</a></code> to define control samples used during centering.
These values are passed to <code><a href='centerGeneData.html'>centerGeneData()</a></code>.</p></td>
    </tr>
    <tr>
      <th>centerGroups</th>
      <td><p>character vector with length equal to <code><a href='https://rdrr.io/r/base/nrow.html'>ncol(x)</a></code>
which defines the group for each column in <code>x</code>. Data will
be centered within each group.</p></td>
    </tr>
    <tr>
      <th>groupedX</th>
      <td><p>logical indicating how to calculate the x-axis
value when <code>centerGroups</code> contains multiple groups. When
groupedX=TRUE, the mean of each group median is used, which
has the effect of representing each group equally. When
groupedX=FALSE, the median across all columns is used, which
can have the effect of preferring sample groups with a larger
number of columns.</p></td>
    </tr>
    <tr>
      <th>useMedian</th>
      <td><p>logical indicating whether to use the median
values when calculating the x-axis and during data centering.
The median naturally reduces the effect of outlier points on
the resulting MA-plots., when compared to using the mean.
When useMedian=FALSE, the mean value is used.</p></td>
    </tr>
    <tr>
      <th>useMean</th>
      <td><p>(deprecated) logical indicating whether to use the
mean instead of the median value. This argument is being removed
in order to improve consistency with other Jam package functions.</p></td>
    </tr>
    <tr>
      <th>whichSamples</th>
      <td><p>character vector containing <code><a href='https://rdrr.io/r/base/colnames.html'>colnames(x)</a></code>, or
integer vector referencing column numbers in <code>x</code>. This argument
specifies which columns to return, but does not change the columns
used to define the group centering values. For example, the
group medians are calculated using all the data, but only the
samples in <code>whichSamples</code> are centered to produce MA-plot data.</p></td>
    </tr>
    <tr>
      <th>noise_floor</th>
      <td><p>numeric value indicating the minimum numeric value
allowed in the input matrix <code>x</code>. When <code>NULL</code> or <code>-Inf</code> no noise
floor is applied. It is common to set <code>noise_floor=0</code> to limit
MA-plot data to use values zero and above.</p></td>
    </tr>
    <tr>
      <th>noise_floor_value</th>
      <td><p>single value used to replace numeric values
at or below <code>noise_floor</code> when <code>noise_floor</code> is not NULL. By default,
<code>noise_floor_value=noise_floor</code> which means values at or below
the noise floor are set to the floor. Another useful option is
<code>noise_floor_value=NA</code> which has the effect of removing the point
from the MA-plot altogether. This option is recommended for sparse
data matrices where the presence of values at or below zero are
indicative of missing data (zero-inflated data) and does not
automatically reflect an actual value of zero.</p></td>
    </tr>
    <tr>
      <th>naValue</th>
      <td><p>single value used to replace any <code>NA</code> values in
the input matrix <code>x</code>. This argument can be useful to replace
<code>NA</code> values with something like zero.</p></td>
    </tr>
    <tr>
      <th>mad_row_min</th>
      <td><p>numeric value defining the minimum group
value, corresponding to the x-axis position on the MA-plot,
required for a row to be included in the MAD calculation.
This threshold is useful to filter outlier data below a noise
threshold, so that the MAD calculation will include only the
data above that value. For example, with count data, it is
useful to filter out counts below roughly 8, where Poisson
noise is a more dominant component than real count data.
Remember that count data should already be log2-transformed,
so the threshold should also be identically transformed,
for example using <code><a href='https://rdrr.io/r/base/Log.html'>log2(1 + 8)</a></code> to set a minimum count
threshold of at least 8.</p></td>
    </tr>
    <tr>
      <th>grouped_mad</th>
      <td><p>logical indicating whether the MAD value
should be calculated per group when <code>centerGroups</code> is
supplied, from which the MAD factor values are derived.
When <code>TRUE</code> it has the effect of highlighting outliers
within each group using the variability in that group.
When <code>FALSE</code> the overall MAD is calculated, and a
particularly high variability group may have all its
group members labeled with a high MAD factor.</p></td>
    </tr>
    <tr>
      <th>centerFunc</th>
      <td><p>function used for centering data, by default
one of the functions <code><a href='centerGeneData.html'>centerGeneData()</a></code> or <code><a href='centerGeneData_v1.html'>centerGeneData_v1()</a></code>.
This argument will be removed in the near future and is mainly
intended to allow testing the two centering functions.</p></td>
    </tr>
    <tr>
      <th>returnType</th>
      <td><p>character string indicating the format of data
to return: <code>"ma_list"</code> is a list of MA-plot two-column
numeric matrices with colnames <code><a href='https://rdrr.io/r/base/c.html'>c("x","y")</a></code>; "tidy"
returns a tall <code>data.frame</code> suitable for use in ggplot2.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical indicating whether to print verbose output.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments are ignored.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes a numeric matrix as input, and calculates
data sufficient to produce MA-plots. The default output is a
list of two-column numeric matrices with <code>"x"</code> and <code>"y"</code> coordinates,
representing the group median and difference from median,
respectively.</p>
<p>The mean value can be used by setting <code>useMedian=FALSE</code>.</p>
<p>Samples can be grouped using the argument <code>centerGroups</code>.
In this case the y-axis value will be "difference from
group median."</p>
<p>Control samples can be specified for centering using the
argument <code>controlSamples</code>. In this case, the y-axis value will
be "difference from control median".</p>
<p>The sample grouping, and control samples can be combined,
in which case the y-axis values will be "difference from
the control median within the centering group."</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other jam matrix functions: 
<code><a href='centerGeneData.html'>centerGeneData</a>()</code>,
<code><a href='jammanorm.html'>jammanorm</a>()</code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


