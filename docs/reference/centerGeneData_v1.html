<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Center gene data — centerGeneData_v1 • jamma</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Center gene data — centerGeneData_v1" />
<meta property="og:description" content="Performs row centering on a matrix of data in log space" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamma</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.16.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/jamma-vignette.html">Introduction to jamma</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="http://github.com/jmw86069/jamma/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Center gene data</h1>
    <small class="dont-index">Source: <a href='http://github.com/jmw86069/jamma/blob/master/R/jamma-center.R'><code>R/jamma-center.R</code></a></small>
    <div class="hidden name"><code>centerGeneData_v1.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs row centering on a matrix of data in log space</p>
    </div>

    <pre class="usage"><span class='fu'>centerGeneData_v1</span><span class='op'>(</span>
  <span class='va'>x</span>,
  floor <span class='op'>=</span> <span class='cn'>NA</span>,
  controlSamples <span class='op'>=</span> <span class='cn'>NA</span>,
  centerGroups <span class='op'>=</span> <span class='cn'>NULL</span>,
  needsLog <span class='op'>=</span> <span class='cn'>NULL</span>,
  mean <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnGroupedValues <span class='op'>=</span> <span class='cn'>FALSE</span>,
  returnValues <span class='op'>=</span> <span class='cn'>TRUE</span>,
  groupPrefix <span class='op'>=</span> <span class='st'>"group"</span>,
  showGroups <span class='op'>=</span> <span class='cn'>FALSE</span>,
  scale <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"none"</span>, <span class='st'>"row"</span><span class='op'>)</span>,
  verbose <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>numeric matrix typically containing measurements (genes)
as rows, and samples as columns.</p></td>
    </tr>
    <tr>
      <th>floor</th>
      <td><p>optional numeric floor, below which values are set to the
floor value, useful when one wants to avoid centering to values which
may be below a noise threshold which might otherwise result in
artificially inflated log fold changes.</p></td>
    </tr>
    <tr>
      <th>controlSamples</th>
      <td><p>optional character vector of colnames(x) to be
used as controls when centering data. In the event that centerGroups
is also defined, the controlSamples are only used within each
group of colnames. When this value is NULL or NA, or when any group
of colnames defined by centerGroups contains no controlSamples, then
all samples are used for centering. This relationship is clearly
described in the attribute named "centerGroups".</p></td>
    </tr>
    <tr>
      <th>centerGroups</th>
      <td><p>optional character vector named by colnames, whose
values are group names. Alternatively, a list of vectors of colnames,
where each list element contains colnames in explicit groups.</p></td>
    </tr>
    <tr>
      <th>mean</th>
      <td><p>logical indicating whether to use row means, or row medians.
If the matrixStats package is available, it uses
<code><a href='https://rdrr.io/pkg/matrixStats/man/rowMedians.html'>matrixStats::rowMedians()</a></code> for calculations, otherwise
falling back to apply(x, 1, median) which is notably slower for
large data matrices.</p></td>
    </tr>
    <tr>
      <th>returnGroupedValues</th>
      <td><p>logical indicating whether to append columns
which contain the control mean or median values used during centering.</p></td>
    </tr>
    <tr>
      <th>showGroups</th>
      <td><p>logical indicating whether to print the sample centring
relationship to screen during processing. Note this information is
also contained in attribute "centerGroups".</p></td>
    </tr>
    <tr>
      <th>scale</th>
      <td><p>character values indicating whether to scale data by row, or
perform no row scaling. Scaling is dependent upon whether median or mean
values are used in centering. If mean values are used, scaling is
accomplished by dividing row values by the standard deviation. If median
is used, then scaling divides row values by the MAD which is derived
using the median instead of the mean.</p></td>
    </tr>
    <tr>
      <th>needsLod</th>
      <td><p>logical, indicating whether to perform log2 transformation
of data prior to centering. If NULL, then if any value is above 40,
it sets needsLog=TRUE and uses log2(x) for centering.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>numeric</code> <code>matrix</code> with the same row and column dimensions
as input data. If <code>returnGroupedValues=TRUE</code>, the additional columns contain
the row median or mean values, dependent upon mean=FALSE or mean=TRUE,
respectively.
An attribute <code>centerGroups</code> is included, which describes the specific
relationship between each colname, and associated control sample colnames,
and optional centerGroups grouping of colnames. When columns are grouped
and centered to specific control samples, is it important to keep this
information during downstream scrutiny of results.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function is deprecated in favor of <code><a href='centerGeneData.html'>centerGeneData()</a></code>
which includes more flexibility in data centering. It is
maintained here for backward compatibility.</p>
<p>This function is a relatively simple wrapper function which subtracts
the row median (or row mean when mean=FALSE) from each row. The function
allows defining a subset of columns to be used in determining the
row control value via controlSamples, Similarly, columns can be grouped,
where columns are centered versus their relevant control samples within
each group of columns.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>, ncol<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span>;
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>letters</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>10</span><span class='op'>]</span>;
<span class='co'># basic centering</span>
<span class='fu'>centerGeneData_v1</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>;
</div><div class='output co'>#&gt;         a   b   c   d  e f  g  h  i  j
#&gt;  [1,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [2,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [3,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [4,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [5,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [6,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [7,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [8,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt;  [9,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt; [10,] -45 -35 -25 -15 -5 5 15 25 35 45
#&gt; attr(,"centerDF")
#&gt;   sample centerControl
#&gt; a      a          TRUE
#&gt; b      b          TRUE
#&gt; c      c          TRUE
#&gt; d      d          TRUE
#&gt; e      e          TRUE
#&gt; f      f          TRUE
#&gt; g      g          TRUE
#&gt; h      h          TRUE
#&gt; i      i          TRUE
#&gt; j      j          TRUE</div><div class='input'>
<span class='co'># grouped centering</span>
<span class='fu'>centerGeneData_v1</span><span class='op'>(</span><span class='va'>x</span>,
   centerGroups<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>,<span class='st'>"B"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>;
</div><div class='output co'>#&gt; <span class='error'>Error in nameVectorN(centerGroups): could not find function "nameVectorN"</span></div><div class='input'>
<span class='co'># centering versus specific control columns</span>
<span class='fu'>centerGeneData_v1</span><span class='op'>(</span><span class='va'>x</span>,
   controlSamples<span class='op'>=</span><span class='va'>letters</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>;
</div><div class='output co'>#&gt;         a b  c  d  e  f  g  h  i  j
#&gt;  [1,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [2,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [3,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [4,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [5,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [6,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [7,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [8,] -10 0 10 20 30 40 50 60 70 80
#&gt;  [9,] -10 0 10 20 30 40 50 60 70 80
#&gt; [10,] -10 0 10 20 30 40 50 60 70 80
#&gt; attr(,"centerDF")
#&gt;   sample centerControl
#&gt; a      a          TRUE
#&gt; b      b          TRUE
#&gt; c      c          TRUE
#&gt; d      d         FALSE
#&gt; e      e         FALSE
#&gt; f      f         FALSE
#&gt; g      g         FALSE
#&gt; h      h         FALSE
#&gt; i      i         FALSE
#&gt; j      j         FALSE</div><div class='input'>
<span class='co'># grouped centering versus specific control columns</span>
<span class='fu'>centerGeneData_v1</span><span class='op'>(</span><span class='va'>x</span>,
   centerGroups<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>,<span class='st'>"B"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,
   controlSamples<span class='op'>=</span><span class='va'>letters</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>;
</div><div class='output co'>#&gt; <span class='error'>Error in nameVectorN(centerGroups): could not find function "nameVectorN"</span></div><div class='input'>
<span class='co'># confirm the centerGroups and controlSamples</span>
<span class='va'>x_ctr</span> <span class='op'>&lt;-</span> <span class='fu'>centerGeneData_v1</span><span class='op'>(</span><span class='va'>x</span>,
   centerGroups<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"A"</span>,<span class='st'>"B"</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5</span>,<span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,
   controlSamples<span class='op'>=</span><span class='va'>letters</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>, <span class='fl'>6</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span>,
   showGroups<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>;
</div><div class='output co'>#&gt;   sample centerGroups centerControl
#&gt; a      a            A          TRUE
#&gt; b      b            A          TRUE
#&gt; c      c            A          TRUE
#&gt; d      d            A         FALSE
#&gt; e      e            A         FALSE
#&gt; f      f            B          TRUE
#&gt; g      g            B          TRUE
#&gt; h      h            B          TRUE
#&gt; i      i            B         FALSE
#&gt; j      j            B         FALSE</div><div class='output co'>#&gt; <span class='error'>Error in nameVectorN(centerGroups): could not find function "nameVectorN"</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/attr.html'>attr</a></span><span class='op'>(</span><span class='va'>x_ctr</span>, <span class='st'>"centerDF"</span><span class='op'>)</span>;
</div><div class='output co'>#&gt; <span class='error'>Error in eval(expr, envir, enclos): object 'x_ctr' not found</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by James Ward.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


