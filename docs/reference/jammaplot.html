<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Produce MA-plot of omics data. — ggjammaplot • jamma</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Produce MA-plot of omics data. — ggjammaplot"><meta property="og:description" content="Produce MA-plot of omics data, where jammaplot() uses base R graphics,
ggjammaplot() uses ggplot2 graphics."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamma</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.21.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/jamma-vignette.html">Introduction to jamma</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/jmw86069/jamma/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Produce MA-plot of omics data.</h1>
    <small class="dont-index">Source: <a href="https://github.com/jmw86069/jamma/blob/HEAD/R/jamma-ggjammaplot.R" class="external-link"><code>R/jamma-ggjammaplot.R</code></a>, <a href="https://github.com/jmw86069/jamma/blob/HEAD/R/jamma.r" class="external-link"><code>R/jamma.r</code></a></small>
    <div class="hidden name"><code>jammaplot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Produce MA-plot of omics data, where <code>jammaplot()</code> uses base R graphics,
<code>ggjammaplot()</code> uses ggplot2 graphics.</p>
    </div>

    <div class="ref-usage sourceCode"><pre class="sourceCode r"><code><span class="fu">ggjammaplot</span><span class="op">(</span>
  <span class="va">x</span>,
  nbin_factor <span class="op">=</span> <span class="fl">1</span>,
  bw_factor <span class="op">=</span> <span class="fl">1</span>,
  assay_name <span class="op">=</span> <span class="fl">1</span>,
  useMedian <span class="op">=</span> <span class="cn">FALSE</span>,
  controlSamples <span class="op">=</span> <span class="cn">NULL</span>,
  centerGroups <span class="op">=</span> <span class="cn">NULL</span>,
  colramp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"transparent"</span>, <span class="st">"lightblue"</span>, <span class="st">"blue"</span>, <span class="st">"navy"</span>, <span class="st">"orange"</span>, <span class="st">"orangered2"</span><span class="op">)</span>,
  groupedX <span class="op">=</span> <span class="cn">TRUE</span>,
  grouped_mad <span class="op">=</span> <span class="cn">TRUE</span>,
  outlierMAD <span class="op">=</span> <span class="fl">5</span>,
  mad_row_min <span class="op">=</span> <span class="fl">4</span>,
  displayMAD <span class="op">=</span> <span class="cn">FALSE</span>,
  noise_floor <span class="op">=</span> <span class="fl">0</span>,
  noise_floor_value <span class="op">=</span> <span class="cn">NA</span>,
  naValue <span class="op">=</span> <span class="cn">NA</span>,
  centerFunc <span class="op">=</span> <span class="va">centerGeneData</span>,
  whichSamples <span class="op">=</span> <span class="cn">NULL</span>,
  useRank <span class="op">=</span> <span class="cn">FALSE</span>,
  titleBoxColor <span class="op">=</span> <span class="st">"lightgoldenrod1"</span>,
  outlierColor <span class="op">=</span> <span class="st">"lemonchiffon"</span>,
  fillBackground <span class="op">=</span> <span class="cn">TRUE</span>,
  maintitle <span class="op">=</span> <span class="cn">NULL</span>,
  subtitle <span class="op">=</span> <span class="cn">NULL</span>,
  summary <span class="op">=</span> <span class="st">"mean"</span>,
  difference <span class="op">=</span> <span class="st">"difference"</span>,
  transFactor <span class="op">=</span> <span class="fl">0.2</span>,
  doPlot <span class="op">=</span> <span class="cn">TRUE</span>,
  highlightPoints <span class="op">=</span> <span class="cn">NULL</span>,
  highlightPch <span class="op">=</span> <span class="fl">21</span>,
  highlightCex <span class="op">=</span> <span class="fl">1.5</span>,
  highlightColor <span class="op">=</span> <span class="cn">NULL</span>,
  doHighlightLegend <span class="op">=</span> <span class="cn">TRUE</span>,
  ablineH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,
  base_size <span class="op">=</span> <span class="fl">12</span>,
  panel.grid.major.colour <span class="op">=</span> <span class="st">"grey90"</span>,
  panel.grid.minor.colour <span class="op">=</span> <span class="st">"grey95"</span>,
  return_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ggplot"</span>, <span class="st">"data"</span><span class="op">)</span>,
  xlim <span class="op">=</span> <span class="cn">NULL</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,
  ncol <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="cn">NULL</span>,
  blankPlotPos <span class="op">=</span> <span class="cn">NULL</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">jammaplot</span><span class="op">(</span>
  <span class="va">x</span>,
  assay_name <span class="op">=</span> <span class="cn">NULL</span>,
  maintitle <span class="op">=</span> <span class="cn">NULL</span>,
  titleBoxColor <span class="op">=</span> <span class="st">"#DDBB9977"</span>,
  subtitleBoxColor <span class="op">=</span> <span class="va">titleBoxColor</span>,
  centerGroups <span class="op">=</span> <span class="cn">NULL</span>,
  controlSamples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  useMedian <span class="op">=</span> <span class="cn">FALSE</span>,
  useMean <span class="op">=</span> <span class="cn">NULL</span>,
  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span>,
  xlim <span class="op">=</span> <span class="cn">NULL</span>,
  highlightPoints <span class="op">=</span> <span class="cn">NULL</span>,
  outlierMAD <span class="op">=</span> <span class="fl">5</span>,
  outlierRowMin <span class="op">=</span> <span class="fl">5</span>,
  displayMAD <span class="op">=</span> <span class="cn">FALSE</span>,
  groupedMAD <span class="op">=</span> <span class="cn">TRUE</span>,
  colramp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"lightblue"</span>, <span class="st">"blue"</span>, <span class="st">"navy"</span>, <span class="st">"orange"</span>, <span class="st">"orangered2"</span><span class="op">)</span>,
  colrampOutlier <span class="op">=</span> <span class="cn">NULL</span>,
  outlierColor <span class="op">=</span> <span class="st">"lemonchiffon"</span>,
  whichSamples <span class="op">=</span> <span class="cn">NULL</span>,
  maintitleCex <span class="op">=</span> <span class="fl">1.8</span>,
  subtitle <span class="op">=</span> <span class="cn">NULL</span>,
  subtitlePreset <span class="op">=</span> <span class="st">"bottomleft"</span>,
  titleCexFactor <span class="op">=</span> <span class="fl">1</span>,
  titleCex <span class="op">=</span> <span class="cn">NULL</span>,
  doTitleBox <span class="op">=</span> <span class="cn">TRUE</span>,
  titleColor <span class="op">=</span> <span class="st">"black"</span>,
  titleFont <span class="op">=</span> <span class="fl">2</span>,
  titlePreset <span class="op">=</span> <span class="st">"top"</span>,
  xlab <span class="op">=</span> <span class="st">""</span>,
  xlabline <span class="op">=</span> <span class="fl">2</span>,
  ylab <span class="op">=</span> <span class="st">""</span>,
  ylabline <span class="op">=</span> <span class="fl">1.5</span>,
  groupSuffix <span class="op">=</span> <span class="cn">NULL</span>,
  highlightPch <span class="op">=</span> <span class="fl">21</span>,
  highlightCex <span class="op">=</span> <span class="fl">1.5</span>,
  highlightColor <span class="op">=</span> <span class="st">"#00AAAA66"</span>,
  doHighlightPolygon <span class="op">=</span> <span class="cn">FALSE</span>,
  highlightPolygonAlpha <span class="op">=</span> <span class="fl">0.3</span>,
  doHighlightLegend <span class="op">=</span> <span class="cn">TRUE</span>,
  smoothPtCol <span class="op">=</span> <span class="st">"#00000055"</span>,
  margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">2</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span>,
  useRaster <span class="op">=</span> <span class="cn">TRUE</span>,
  ncol <span class="op">=</span> <span class="cn">NULL</span>,
  nrow <span class="op">=</span> <span class="cn">NULL</span>,
  doPar <span class="op">=</span> <span class="cn">TRUE</span>,
  las <span class="op">=</span> <span class="fl">2</span>,
  groupedX <span class="op">=</span> <span class="cn">TRUE</span>,
  customFunc <span class="op">=</span> <span class="cn">NULL</span>,
  filterNA <span class="op">=</span> <span class="cn">TRUE</span>,
  filterNAreplacement <span class="op">=</span> <span class="cn">NA</span>,
  filterNeg <span class="op">=</span> <span class="cn">TRUE</span>,
  noise_floor <span class="op">=</span> <span class="fl">0</span>,
  noise_floor_value <span class="op">=</span> <span class="cn">NA</span>,
  filterFloor <span class="op">=</span> <span class="cn">NULL</span>,
  filterFloorReplacement <span class="op">=</span> <span class="cn">NULL</span>,
  transFactor <span class="op">=</span> <span class="fl">0.18</span>,
  nrpoints <span class="op">=</span> <span class="fl">0</span>,
  smoothScatterFunc <span class="op">=</span> <span class="fu">jamba</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">plotSmoothScatter</a></span>,
  applyRangeCeiling <span class="op">=</span> <span class="cn">TRUE</span>,
  doTxtplot <span class="op">=</span> <span class="cn">FALSE</span>,
  ablineV <span class="op">=</span> <span class="fl">0</span>,
  ablineH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>,
  blankPlotPos <span class="op">=</span> <span class="cn">NULL</span>,
  fillBackground <span class="op">=</span> <span class="cn">TRUE</span>,
  useRank <span class="op">=</span> <span class="cn">FALSE</span>,
  ma_method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"jammacalc"</span>, <span class="st">"old"</span><span class="op">)</span>,
  doPlot <span class="op">=</span> <span class="cn">TRUE</span>,
  verbose <span class="op">=</span> <span class="cn">FALSE</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>

    <div id="ref-sections">
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code>numeric</code> object usually a <code>matrix</code> that contains
values with measurement rows, and sample/observation columns.
For example, with gene or protein expression data, the genes
or proteins (or the assays of genes or proteins) are
represented in rows, and obtained samples are represented
in columns. Alternatively <code>x</code> can be <code>SummarizedExperiment</code>
object, used alongside argument <code>assay_name</code>.</p></dd>
<dt>nbin_factor</dt>
<dd><p><code>numeric</code> value used to adjust the number of bins
used to display the MA-plots, where values higher than <code>1</code> increase
the resolution and level of detail, and values below <code>1</code> decrease
the resolution. Note the number of bins are already adjusted based
upon the square root of the number of plot panels, and <code>nbin_factor</code>
applied to that value.</p></dd>
<dt>bw_factor</dt>
<dd><p><code>numeric</code> used to adjust the resolution of the
2-dimensional bandwidth calculation, where higher values create
more detailed density, and lower values create a smoother density
across the range of data.</p></dd>
<dt>assay_name</dt>
<dd><p><code>character</code> used when <code>x</code> is a
<code>SummarizedExperiment</code> object, to determine which assay
<code>matrix</code> to use for the MA plots. When <code>assay_name=NULL</code>
the first assay entry is used, for example <code>assays(x)[[1]]</code>.</p></dd>
<dt>useMedian</dt>
<dd><p><code>logical</code> indicates whether to center data
using the <code>median</code> value, where <code>useMedian=FALSE</code> by default.
For consistency, this argument is preferred to <code>useMean</code> which
is deprecated and will be removed in future. The median is
preferred in cases where outliers should not influence the
centering. The mean is preferred in cases where the data
should visualize data consistent with downstream parametric
statistical analysis. When a particular sample
is a technical outlier, one option is to define
<code>controlSamples</code> to exclude the outlier sample(s), so
the data centering will be applied using the non-outlier
samples as reference.</p></dd>
<dt>controlSamples</dt>
<dd><p><code>character</code> vector of <code>colnames(x)</code> passed
to <code><a href="centerGeneData.html">centerGeneData()</a></code> which defines the control samples during
the data centering step.
By default, and the most common practice, MA-plots are
calculated across all samples, which effectively uses all
<code>colnames(x)</code> as <code>controlSamples</code>.
However, it is quite useful sometimes to provide a subset of
samples especially if there are known quality samples, to which
new samples of unknown quality are being compared.</p></dd>
<dt>centerGroups</dt>
<dd><p><code>character</code> vector of groups passed to
<code><a href="centerGeneData.html">jamma::centerGeneData()</a></code> which determines how data is centered.
Each group is centered independently, to enable visual
comparisons within each relevant centering group.
It is useful to center within batches or within
subsets of samples that are not intended to be compared to
one another.
Another useful alternative is to center by each sample
group in order to view the variability among group
replicates, which should be much lower than variability across
sample groups. See <code><a href="centerGeneData.html">centerGeneData()</a></code> for more specific examples.</p></dd>
<dt>colramp</dt>
<dd><p>one of several inputs recognized by
<code><a href="https://rdrr.io/pkg/jamba/man/getColorRamp.html" class="external-link">jamba::getColorRamp()</a></code>. It typically recognizes either the name of
a color ramp from RColorBrewer, the name of functions from the
<code>viridis</code> package such as <code><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis::viridis()</a></code>, or single R colors, or
a vector of R colors. When a single color is supplied, a gradient
is created from white to that color, where the default base color
can be customized with <code>defaultBaseColor="black"</code> for example.</p></dd>
<dt>groupedX</dt>
<dd><p><code>logical</code> indicating whether the x-axis value, which
represents the median or mean value, should be calculated independently
for each group when <code>centerGroups</code> is used with multiple groups.
Typically <code>groupedX=TRUE</code> is recommended, however it can be beneficial
to share an overall x-axis value in specific circumstances.</p></dd>
<dt>grouped_mad</dt>
<dd><p><code>logical</code> indicating whether the MAD factor calculation
of variability among samples should be performed independently
for each group when <code>centerGroups</code> is used with multiple groups.
Typically <code>grouped_max=TRUE</code> is recommended, however it can be beneficial
to share an overall MAD factor threshold across all samples
in specific circumstances.</p></dd>
<dt>outlierMAD</dt>
<dd><p><code>numeric</code> threshold above which a MA-plot panel
MAD factor is considered an outlier. When a MA-plot panel is
considered an outlier, the <code>outlierColramp</code> or <code>outlierColor</code>
is applied to the panel color ramp to display a visual
indication.</p></dd>
<dt>mad_row_min</dt>
<dd><p><code>numeric</code> value indicating the minimum x-axis
value, calculated using either median or mean as defined by
argument <code>useMedian</code>, at or above which a measurement is used in the
MAD factor calculation. This threshold is useful to restrict the
MAD variability calculation to measurements (rows in <code>x</code>) with
signal that meets a minimum noise threshold.</p></dd>
<dt>displayMAD</dt>
<dd><p><code>logical</code> indicating whether to display each
MA-plot panel MAD factor (median absolute deviation). A MAD
value for each panel is calculated by taking the median absolute
deviation from zero across all points, using points whose mean
value is equal or greater than <code>outlierRowMin</code>. The overall MAD
is defined by the median MAD from the MA-plot panels. The MAD
factor is defined as the ratio of each MA-plot panel MAD value
to the overall MAD value, and therefore most MAD factor values
should be roughly <code>1</code>. The overall MAD value is defined by the
median across all samples when <code>groupedMAD=FALSE</code>, or defined
within each <code>centerGroup</code> when <code>groupedMAD=TRUE</code>. A value
with MAD factor 2 is interpreted as a sample whose median
deviation from zero is twice as high as the typical sample,
which is a reasonably indication that this sample has twice
the inherent level of noise compared to other samples. Note
that MAD values should be interpreted within sample processing
batches if relevant, or within logical experimental units --
roughly interpreted to mean sets of samples within which direct
statistical comparisons are intended to be applied. For example,
gene expression data that include brain and liver samples would
probably use <code>centerGroups</code> for brain and liver to be centered
separately, therefore the MAD factors should be separately
calculated for brain and for liver.</p></dd>
<dt>noise_floor, noise_floor_value</dt>
<dd><p><code>numeric</code> to define a numeric
floor, or <code>NULL</code> for no numeric floor. Values <strong>at or below</strong>
<code>noise_floor</code> are set to <code>noise_floor_value</code>, intended for two
potential uses:</p><ol><li><p>Filter out value below a threshold, so they do not affect centering.</p><ul><li><p>This option is valuable to remove zeros when a zero <code>0</code> is considered
"no measurement observed", typically for count data such as RNA-seq,
NanoString, and especially single-cell protocols or other protocols
that produce a large number of missing values.</p></li>
<li><p>One can typically tell whether input data includes zero <code>0</code>
values by the presence of characteristic 45-degree angle lines
originating from <code>x=0</code> angled toward the right. The points along
this line are rows with more measurements of zero than non-zero,
there this sample has a non-zero value.</p></li>
</ul></li>
<li><p>Set values at a noise floor to the noise floor, to retain the
measurement but minimize the effect during centering to the lowest
realiable measurement for the platform technology.</p><ul><li><p>This value may be set to a platform noise floor
for something like microarray data where the intensity may be
unreliable below a threshold; or</p></li>
<li><p>for quantitative PCR measurements where cycle threshold (Ct)
values may become unreliable, for example above CT=40 or CT=35.
Data is often transformed to abundance with <code>2 ^ (40 - CT)</code> then
log2-transformed for analysis. In this case, to apply a <code>noise_floor</code>
effective for CT=35, one would use <code>noise_floor=5</code>.</p></li>
</ul></li>
</ol></dd>
<dt>naValue</dt>
<dd><p><code>character</code> string used to convert values of <code>NA</code> to
something else. This argument is useful when a numeric matrix may
contain <code>NA</code> values but would prefer them to be, for example, <code>0</code>.</p></dd>
<dt>centerFunc</dt>
<dd><p><code>function</code> used to supply a custom data centering
function. In practice this argument should rarely be changed.</p></dd>
<dt>whichSamples</dt>
<dd><p><code>NULL</code> or <code>integer</code> vector, representing
an index subset of samples to include in the MA-plots. When
<code>whichSamples</code> represents a subset of samples in <code>x</code>, the
MA-plot calculations are performed on all samples, then only
samples in <code>whichSamples</code> are displayed. This argument keeps
the MA-plot calculations consistent even when viewing only
one or a subset of samples in more detail.</p></dd>
<dt>useRank</dt>
<dd><p><code>logical</code> indicating whether to create column-wide
ranks, then create MA-plots using the rank data. When <code>useRank=TRUE</code>
the y-axis represents the rank difference from mean, and the
x-axis represents the mean rank. Using <code>useRank=TRUE</code> is a good
method to evaluate whether data can be normalized, or whether
data across samples is inherently noisy.</p></dd>
<dt>titleBoxColor</dt>
<dd><p><code>character</code> vector of R colors, where
<code>titleBoxColor</code> is equal to <code>ncol(x)</code>, or where
<code>names(titleBoxColor)</code> matches <code>colnames(x)</code>. When supplied, each
plot panel strip background will be colored accordingly.</p></dd>
<dt>outlierColor</dt>
<dd><p><code>character</code> string representing one R color,
used when <code>colrampOutlier</code> is <code>NULL</code> and when <code>outlierMAD</code> is
defined. This color is used for MA-plot outlier panels by
substituting the first color from the <code>colramp</code> color ramp,
to act as a visual cue that the panel represents an outlier.</p></dd>
<dt>fillBackground</dt>
<dd><p><code>logical</code> currently used for base R graphics
output, and passed to <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code>,
indicating whether to fill the plot panel using the
first color in the color ramp for each MA-plot panel, or when
a plot panel is an outlier, it uses <code>outlierColor</code>.
This argument is mainly useful to highlight outlier panels,
although it is also useful when the color ramp has non-white
base color, for example <code><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis::viridis()</a></code>.</p></dd>
<dt>maintitle</dt>
<dd><p><code>character</code> string with the title displayed above
all individual MA-plot panels. It will appear in the top outer
margin.</p></dd>
<dt>subtitle</dt>
<dd><p><code>NULL</code> or <code>character</code> vector to be drawn at
the bottom left corner of each plot panel, the location
is defined by <code>subtitlePreset</code>.</p></dd>
<dt>transFactor</dt>
<dd><p><code>numeric</code> adjustment to the visual density of
smooth scatter points. For base R graphics, this argument is
passed to <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code>. The argument value is based upon
<code><a href="https://rdrr.io/r/graphics/smoothScatter.html" class="external-link">graphics::smoothScatter()</a></code> argument <code>transformation</code>, which uses
default <code>function(x)x^0.25</code>. The <code>transFactor</code> is equivalent to the
exponential in the form: <code>function(x)x^transFactor</code>. Lower values
make the point density more visually intense, higher values make the
point density less visually intense.</p></dd>
<dt>doPlot</dt>
<dd><p><code>logical</code> indicating whether to create plots. When
<code>doPlot=FALSE</code> only the MA-plot panel data is returned.</p></dd>
<dt>highlightPoints</dt>
<dd><p><code>NULL</code>, or <code>character</code> vector, or a
<code>list</code> of <code>character</code> vectors indicating <code>rownames(x)</code> to
highlight in each MA-plot panel. When <code>NULL</code>, no points are
highlighted; when <code>character</code> vector, points are highlighted in
all MA-plot panels; when <code>list</code> of <code>character</code> vectors, each
<code>character</code> vector in the list is highlighted using a unique
color in <code>highlightColor</code>. Points are drawn using
<code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">graphics::points()</a></code> and colored using <code>highlightColor</code>,
which can be time-consuming for a large number of highlight
points.</p></dd>
<dt>highlightCex</dt>
<dd><p><code>numeric</code> value recycled to <code>length(highlightPoints)</code>
indicating the highlight point size.</p></dd>
<dt>highlightColor</dt>
<dd><p><code>character</code> vector used when <code>highlightPoints</code>
is defined. It is recycled to <code>length(highlightPoints)</code> and
is applied either to</p></dd>
<dt>doHighlightLegend</dt>
<dd><p><code>logical</code> indicating whether to print a
color legend when <code>highlightPoints</code> is defined. The legend is
displayed in the bottom outer margin of the page using
<code><a href="outer_legend.html">outer_legend()</a></code>, and the page is adjusted to add bottom
outer margin.</p></dd>
<dt>ablineH, ablineV</dt>
<dd><p><code>numeric</code> vector indicating position of
horizontal and vertical lines in each MA-plot panel.</p></dd>
<dt>ylim, xlim</dt>
<dd><p><code>NULL</code> or <code>numeric</code> vector <code>length=2</code> indicating
the y-axis and x-axis ranges, respectively. The values are useful
to define consistent dimensions across all panels. The
default <code>ylim=c(-4,4)</code> represents 16-fold up and down range in
normal space, and is typically a reasonable starting point for
most purposes. Even if numeric values are all between
<code>-1.5</code> and <code>1.5</code>, it is still recommended to keep a range in
context of <code>c(-4, 4)</code>, to indicate that the observed values
are lower than typically observed. The <code>c(-4, 4)</code> may be adjusted
relative to the typical ranges expected for the data.
It is sometimes helpful to define <code>xlim</code> slightly above zero for
datasets that have an extremely large proportion of zeros, in order
to reduce the visual effect of having that much point density at
zero, for example with <code>xlim=c(0.001, 20)</code> and
<code>applyRangeCeiling=FALSE</code>.</p></dd>
<dt>ncol, nrow</dt>
<dd><p><code>integer</code> number of MA-plot panel columns and rows
passed to <code>graphics::par("mfrow")</code> when <code>doPar=TRUE</code>. When only one
value is supplied, <code>nrow</code> or <code>ncol</code>, the other value is defined
by <code>ncol(x)</code> and <code>blankPlotPos</code> so all panels can be contained on
one page. When <code>nrow</code> and <code>ncol</code> are defined such that multiple
pages are produced, each page will be annotated with <code>maintitle</code>
and <code>doHighlightLegend</code> as relevant.</p></dd>
<dt>blankPlotPos</dt>
<dd><p><code>NULL</code> or <code>integer</code> vector indicating
plot panel positions to be drawn blank, and therefore skipped.
Plot panels are drawn in the exact order of <code>colnames(x)</code> received.
Blank panel positions are intended to help customize the visual
alignment of MA-plot panels. The mechanism is similar to
<code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code> except that blank positions can be manually
defined by what makes sense for the experiment design.</p></dd>
<dt>verbose</dt>
<dd><p>logical indicating whether to print verbose output.</p></dd>
<dt>...</dt>
<dd><p>additional parameters sent to downstream functions,
<code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter</a></code>, <code><a href="centerGeneData.html">centerGeneData</a></code>.</p></dd>
<dt>useMean</dt>
<dd><p><code>logical</code> (deprecated), use <code>useMean</code>. This argument
indicates whether to center data using the <code>mean</code> value.
When <code>useMean=NULL</code> the argument <code>useMedian</code> is preferred.
For backward compatibility, when <code>useMean</code> is not <code>NULL</code>,
then <code>useMedian</code> is defined by <code>useMedian &lt;- !useMean</code>.</p></dd>
<dt>outlierRowMin</dt>
<dd><p><code>numeric</code> value indicating the minimum mean
value as displayed on the MA-plot panel x-axis, in order for
the row to be included in MAD calculations. This argument is
intended to prevent measurements whose mean value is below
a noise threshold from being included, therefore only including
points whose mean measurement is above noise and represents
"typical" variability.</p></dd>
<dt>groupedMAD</dt>
<dd><p><code>logical</code> indicating how the MAD calculation
should be performed: <code>groupedMAD=TRUE</code> will calculate the
median MAD and corresponsing MAD factor within each
<code>centerGroups</code> grouping; <code>groupedMAD=FALSE</code> will calculate
one overall median MAD, and corresponding MAD factor values
will be performed across all samples.</p></dd>
<dt>colrampOutlier</dt>
<dd><p>one of several inputs recognized by
<code><a href="https://rdrr.io/pkg/jamba/man/getColorRamp.html" class="external-link">jamba::getColorRamp()</a></code> to define a specific color ramp for
MA-plot outlier panels, used when <code>outlierMAD</code> is defined.
When <code>colrampOutlier</code> is <code>NULL</code> the <code>outlierColor</code> is used.</p></dd>
<dt>maintitleCex</dt>
<dd><p><code>numeric</code> cex character expansion used to
resize the <code>maintitle</code>.</p></dd>
<dt>subtitlePreset</dt>
<dd><p>character value describing where to position the
subtitle, using terms valid in <code><a href="https://rdrr.io/pkg/jamba/man/coordPresets.html" class="external-link">jamba::coordPresets()</a></code>. The default
<code>subtitlePreset="bottomleft"</code> places the subtitle at the
bottom left corner of each plot panel.</p></dd>
<dt>doTitleBox</dt>
<dd><p><code>logical</code> indicating whether to draw plot
titles using a colored box. When <code>doTitleBox=TRUE</code> the
<code><a href="https://rdrr.io/pkg/jamba/man/drawLabels.html" class="external-link">jamba::drawLabels()</a></code> is called to display a label box at
the top of each plot panel, with <code>drawBox=TRUE</code>. When
<code>doTitleBox=FALSE</code>, <code><a href="https://rdrr.io/pkg/jamba/man/drawLabels.html" class="external-link">jamba::drawLabels()</a></code> is called with
<code>drawBox=FALSE</code>.</p></dd>
<dt>titleColor</dt>
<dd><p><code>character</code> vector of colors applied to title text
in each MA-plot panel. When <code>doTitleBox=TRUE</code> and <code>titleColor</code>
contains only one or no value, the title color is defined by
<code><a href="https://rdrr.io/pkg/jamba/man/setTextContrastColor.html" class="external-link">jamba::setTextContrastColor()</a></code> along with <code>titleBoxColor</code>.</p></dd>
<dt>titleFont</dt>
<dd><p><code>integer</code> font compatible with <code>par("font")</code>.
Values are recycled across panels, so each panel can use a custom
value if needed.</p></dd>
<dt>titlePreset</dt>
<dd><p><code>character</code> value describing where to position the
subtitle, using terms valid in <code><a href="https://rdrr.io/pkg/jamba/man/coordPresets.html" class="external-link">jamba::coordPresets()</a></code>.
The default <code>titlePreset="top"</code> centers the label at the
top of each panel.</p></dd>
<dt>xlab, ylab</dt>
<dd><p><code>character</code> x- and y-axis labels, respectively.
The default values are blank <code>""</code> because there are a wide variety
of possible labels, and the labels take up more space
than is often useful for most MA-plots.</p></dd>
<dt>xlabline, ylabline</dt>
<dd><p><code>numeric</code> number indicating the text line
distance from the edge of plot border to place <code>xlab</code> and <code>ylab</code>
text, as used by <code><a href="https://rdrr.io/r/graphics/title.html" class="external-link">graphics::title()</a></code>.</p></dd>
<dt>groupSuffix</dt>
<dd><p><code>character</code> text appended to each MA-plot
panel title. This argument is deprecated in favor of
using <code>subtitle</code> to place additional text at the bottom left
corner of each MA-plot panel.</p></dd>
<dt>doHighlightPolygon</dt>
<dd><p><code>logical</code> indicating whether to draw
a shaded polygon encompassing <code>highlightPoints</code>, using
<code>highlightColor</code>.The polygon is defined by <code><a href="https://rdrr.io/r/grDevices/chull.html" class="external-link">grDevices::chull()</a></code>
via the function <code><a href="points2polygonHull.html">points2polygonHull()</a></code>.</p></dd>
<dt>highlightPolygonAlpha</dt>
<dd><p><code>numeric</code> value indicating alpha
transparency, where <code>0</code> is fully transparent, and <code>1</code> is completely
not transparent.</p></dd>
<dt>smoothPtCol</dt>
<dd><p><code>color</code> used to draw points when <code>nrpoints</code> is
non-zero, which draws points in the extremities of the
smooth scatter plot. See <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code>.
The effect can also be achieved by adjusting <code>transFactor</code> to
a lower value, which increases the visual contrast of individual
points in the point density.</p></dd>
<dt>margins</dt>
<dd><p><code>numeric</code> vector of margins compatible with
<code>graphics::par("mar")</code>. Default values
are applied, but provided here for convenience.</p></dd>
<dt>useRaster</dt>
<dd><p><code>logical</code> indicating whether to draw the
smooth scatter plot using raster logic, <code>useRaster=TRUE</code> is
passed to <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code>. The default <code>TRUE</code>
creates a much smaller plot object by rendering each plot
panel as a single raster image instead of rendering individual
colored rectangles.</p></dd>
<dt>doPar</dt>
<dd><p><code>logical</code> indicating whether to apply
<code>graphics::par("mfrow")</code> to define MA-plot panel rows and columns.
When <code>doPar=FALSE</code> each plot panel is
rendered without adjusting the <code>graphics::par("mfrow")</code> setting.</p></dd>
<dt>las</dt>
<dd><p><code>integer</code> value <code>1</code> or <code>2</code> indicating whether axis labels
should be parallel or perpendicular to the axes, respectively.</p></dd>
<dt>customFunc</dt>
<dd><p><code>NULL</code> or <code>function</code> used instead of <code>mean</code> or
<code>median</code> during the data centering step to generate a row summary
statistic. It should take <code>matrix</code> input, and return a <code>numeric</code> vector
output summarizing each row in <code>x</code>, to be subtracted from each
<code>numeric</code> value by row in <code>x</code>. It is intended to
provide custom row statistics, for example geometric mean, or other
row summary function.</p></dd>
<dt>filterNA, filterNAreplacement</dt>
<dd><p><code>logical</code> and <code>vector</code> respectively.
When <code>filterNA=TRUE</code>, all <code>NA</code> values are replaced with
<code>filterNAreplacement</code>, which can be helpful to handle <code>NA</code> values
as zero <code>0</code> for example. In reality, <code>NA</code> values should probably
be left as-is, so subsequent data centering does not use these values,
and so the MA-plot panel does not draw a point when no measurement
exists.</p></dd>
<dt>filterNeg</dt>
<dd><p><code>logical</code> deprecated argument, use <code>filterFloor</code>
instead. The <code>filterNeg</code> indicates whether to change all negative
values to zero <code>0</code> before proceeding with data centering.
Negative values are often the result of measurements
being below a noise threshold in upstream data processing,
and therefore the magnitude of negative value is usually
either not informative, or not on similar scale as positive
values.
When <code>filterNeg=TRUE</code>, negative values are set to zero, and
can result in a characteristic 45 degree angle line originating at
<code>x=0</code> extending to the right.</p></dd>
<dt>filterFloor, filterFloorReplacement</dt>
<dd><p>(deprecated) in favor of
<code>noise_floor</code>, and <code>noise_floor_replacement</code> respectively.</p></dd>
<dt>nrpoints</dt>
<dd><p><code>integer</code> or <code>NULL</code> indicating the number of points
to display on the extremity of the smooth scatter density,
passed to <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code>.</p></dd>
<dt>smoothScatterFunc</dt>
<dd><p><code>function</code> used to produce a smooth scatter plot
in base R graphics. The default <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code> controls
the level of detail in the density calculation, and in the graphical
resolution of that density in each plot panel. The custom function
should accept argument <code>transformation</code> as described in <code>transFactor</code>,
even if the argument is not used.</p></dd>
<dt>applyRangeCeiling</dt>
<dd><p><code>logical</code> passed to
<code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code> which determines how to handle points
outside the plot x-axis and y-axis range: <code>applyRangeCeiling=TRUE</code>
will place points at the border of the plot, which is helpful
to indicate that there are more points outside the viewing range;
<code>applyRangeCeiling=FALSE</code> will crop and remove points outside
the viewing range, which is helpful for example when a large
number of points are at zero and overwhelm the point density.
When there are a large proportion of values at zero, it
can be helpful to apply <code>xlim=c(0.01, 20)</code> and
<code>applyRangeCeiling=FALSE</code>.</p></dd>
<dt>doTxtplot</dt>
<dd><p><code>logical</code> (not yet implemented in <code>jamma</code>),
indicating to produce colored ANSI text plot output, for example
to a text terminal.</p></dd>
<dt>ma_method</dt>
<dd><p>character string indicating whether to perform
MA-plot calculations using the old method <code>"old"</code>; or <code>"jammacalc"</code>
which uses the function <code><a href="jammacalc.html">jammacalc()</a></code>.</p></dd>
<dt>titleBoxColor, subtitleBoxColor</dt>
<dd><p><code>character</code> vector of
R colors used as background color for each panel title text,
or subtitle text respectively. The subtitle appears in the
bottom-left corner, and usually indicates the center groups
as defined by <code>centerGroups</code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>list</code> of <code>numeric</code><code>matrix</code> objects, one for each MA-plot,
with colnames <code>"x"</code> and <code>"y"</code>. This <code>list</code> is sufficient input
to <code>jammaplot()</code> to re-create the full set of MA-plots.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>jammaplot</code> takes a numeric matrix, typically of gene expression data,
and produces an MA-plot (Bland-Altman plot), also known as a
median-difference plot. One panel is created for each column of
data. Within each panel, the x-axis represents the mean or median
expression of each row; the y-axis represents the difference from
mean or median for that column.</p>
<p>By default, the plot uses <code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code>, with optional
highlighted points draw using <code><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points()</a></code>.</p>
<p>The function will determine an appropriate layout of plot panels,
which can be overridden using <code>ncol</code> and <code>nrow</code> to specify the
number of columns and rows of plot panels, respectively. For now,
this function uses base R graphics instead of ggplot2, in order
to accomodate some custom features.</p>
<p>This function uses "useRaster=TRUE" by default, which causes
<code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code> to render a rasterized image as opposed
to a composite of colored rectangles. This process substantially
reduces the render time in all cases, and reduces the image size
when saving as PDF or SVG.</p><div class="section">
<h3 id="notable-features">Notable features<a class="anchor" aria-label="anchor" href="#notable-features"></a></h3>

<div class="section">
<h4 id="highlighting-points">Highlighting points<a class="anchor" aria-label="anchor" href="#highlighting-points"></a></h4>


<p>Specific points can be highlighted with argument <code>highlightPoints</code>
which can be a vector or named list of vectors, containing <code>rownames(x)</code>.
When using a list, point colors are assigned to each element in the
list in order, using the argument <code>highlightColor</code>.</p>
</div>

<div class="section">
<h4 id="centering-by-control-samples">Centering by control samples<a class="anchor" aria-label="anchor" href="#centering-by-control-samples"></a></h4>


<p>Typical MA-plots are "global-centered", which calculates the
mean/median across all columns in <code>x</code>, and this value is subtracted
from each individual value per row.</p>
<p>By specifying <code>controlSamples</code>
the mean/median is calculated using only the <code>colnames(x)</code> which match
<code>controlSamples</code>, thus representing "difference from control."</p>
<p>It may also be useful to center data by known high-quality samples,
so the effect of potential outlier samples is avoided.</p>
</div>

<div class="section">
<h4 id="centering-within-subgroups">Centering within subgroups<a class="anchor" aria-label="anchor" href="#centering-within-subgroups"></a></h4>


<p>By specifying <code>centerGroups</code> as a vector of group names,
the centering is calculated within each group of <code>colnames(x)</code>.
In this way, subsets of samples can be treated independently in
the MA-plots. A good example might be producing MA-plots for
"kidney" samples, and "muscle" samples, which may have
fundamentally different signal distributions. A good rule
of thumb is to apply <code>centerGroups</code> to represent separate
groups of samples where you do not intend to apply direct
statistical comparisons across those samples, without at
least applying a two-way contrast, a fold change of fold
changes.</p>
<p>Another informative technique is to center by sample group,
for example <code>centerGroups=sample_group</code>.
This technique produces MA-plots that depict the
"difference from group" for each sample replicate of a sample
group, and is very useful for identifying sample replicates
with markedly higher variability to its sample group than
others. In general, the variability within sample group
should be substantially lower than variability across
sample groups. Use <code>displayMAD=TRUE</code> and <code>outlierMAD=2</code>
as a recommended starting point for this technique.</p>
</div>

<div class="section">
<h4 id="applying-a-noise-floor">Applying a noise floor<a class="anchor" aria-label="anchor" href="#applying-a-noise-floor"></a></h4>


<p>The argument <code>noise_floor</code> provides a numeric lower threshold,
where individual values <strong>at or below</strong> this threshold are
set to a defined value, defined by argument <code>noise_floor_value</code>.
The default was updated in version <code>0.0.21.900</code> to
<code>noise_floor=0</code> and <code>noise_floor_value=NA</code>.
Values of zero <code>0</code> are set to <code>NA</code> and therefore are not included
in the MA-plot calculations. Only points above zero are included
as points in each MA-plot panel.</p>
<p>Another useful alternative is to define <code>noise_floor_value=noise_floor</code>
which sets any measurement <strong>at or below</strong> the <code>noise_floor</code> to
this value. This option has the effect of reducing random noise from
points that are already below the noise threshold and therefore
are unreliable for this purpose.</p>
</div>

<div class="section">
<h4 id="customizing-the-panel-layout">Customizing the panel layout<a class="anchor" aria-label="anchor" href="#customizing-the-panel-layout"></a></h4>


<p>Panels are drawn using the order of <code>colnames(x)</code> by row,
from left-to-right, then top-to-bottom.
The argument <code>blankPlotPos</code> is intended to insert an empty panel
at a particular panel position, to help customize the alignment
of sample panels.
This option is typically used with <code>ncol</code> and <code>nrow</code> to define
a fixed layout of panel columns and rows. <code>blankPlotPos</code> refers
to panels numbered as drawn per row of panels,</p>
</div>

<div class="section">
<h4 id="identifying-potential-sample-outliers">Identifying potential sample outliers<a class="anchor" aria-label="anchor" href="#identifying-potential-sample-outliers"></a></h4>


<p>Use argument <code>displayMAD=TRUE</code> to display the per-sample MAD factor
relative to its <code>centerGroups</code> value, if provided. The MAD value
for each MA-plot panel is calculated using rows whose mean
is at or above <code>outlierRowMin</code>. The median MAD value is calculated
for each <code>centerGroups</code> grouping when <code>groupedMAD=TRUE</code>, by default.
Finally, each MA-plot panel MAD factor is the ratio of its MAD value
to the relevant median MAD value. MA-plot panels with MAD factor
above <code>outlierMAD</code> are considered outliers, and the color ramp
uses <code>outlierColramp</code> or <code>outlierColor</code> as a visual cue.</p>
<p>Putative outlier samples should usually not be determined
when:</p><ul><li><p><code>controlSamples</code> are defined to include only a subset
of sample groups,</p></li>
<li><p><code>centerGroups</code> is not defined, or represents more than one
set of sample groups that are not intended to be statistically
compared directly to one another.</p></li>
</ul><p>Putative outlier samples may be defined when:</p><ul><li><p><code>centerGroups</code> represents a set of sample groups that are
intended to be involved in direct comparisons</p></li>
<li><p><code>centerGroups</code> represents each sample group</p></li>
</ul><p>Potential sample outliers may be identified by setting a threshold
with <code>outlierMAD</code>, by default 5xMAD. For a sample to be considered
an outlier, its median difference from mean/median needs to be
five times higher than the median across samples.</p>
<p>We typically recommend an <code>outlierMAD=2</code> when centering
by sample groups, or when centering within experiment subsets.
For one sample to have 2xMAD factor, its variance needs
to be uniquely twice as high as the majority of other samples, which
is typically symptomatic of possible technical failure.</p>
<p>There are exceptions to this suggested guideline, which includes
scenarios where a batch effect may be involved.</p>
<p>To do:</p><ul><li><p>Accept other object types as input, including Bioconductor
classes: <code>ExpressionSet</code>, <code>SummarizedExperiment</code>,
<code>MultiExperimentSet</code></p></li>
<li><p>Make it efficient to convey group information, for example
define <code>titleBoxColor</code> with group colors, allow <code>centerByGroup=TRUE</code>
which would re-use known sample group information.</p></li>
<li><p>Adjust the suffix to indicate when <code>centerGroups</code> are being
used. For example indicate <code>'sampleID vs groupA'</code> instead of
<code>'sampleID vs median'</code>.</p></li>
</ul></div>


</div>

    </div>
    <div id="functions">
    <h2>Functions</h2>
    
<ul><li><p><code>ggjammaplot</code>:</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/jamba/man/plotSmoothScatter.html" class="external-link">jamba::plotSmoothScatter()</a></code> for enhanced
<code><a href="https://rdrr.io/r/graphics/smoothScatter.html" class="external-link">graphics::smoothScatter()</a></code>, <code><a href="centerGeneData.html">centerGeneData()</a></code>,
<code><a href="https://rdrr.io/pkg/jamba/man/imageDefault.html" class="external-link">jamba::imageDefault()</a></code>, <code><a href="https://rdrr.io/pkg/jamba/man/nullPlot.html" class="external-link">jamba::nullPlot()</a></code></p></div>
    </div>
    </div>

    <div id="examples">
    <h2>Examples</h2>
    <div class="ref-examples sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/check_pkg_installed.html" class="external-link">check_pkg_installed</a></span><span class="op">(</span><span class="st">"SummarizedExperiment"</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span>
<span class="r-in">   <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/check_pkg_installed.html" class="external-link">check_pkg_installed</a></span><span class="op">(</span><span class="st">"farrisdata"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">SummarizedExperiment</span><span class="op">)</span><span class="op">)</span>;</span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">GeneSE</span> <span class="op">&lt;-</span> <span class="fu">farrisdata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/farrisdata/man/farrisGeneSE.html" class="external-link">farrisGeneSE</a></span>;</span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">titleBoxColor</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/nameVector.html" class="external-link">nameVector</a></span><span class="op">(</span></span>
<span class="r-in">      <span class="fu">farrisdata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/farrisdata/man/colorSub.html" class="external-link">colorSub</a></span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">GeneSE</span><span class="op">)</span><span class="op">$</span><span class="va">groupName</span><span class="op">)</span><span class="op">]</span>,</span>
<span class="r-in">      <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GeneSE</span><span class="op">)</span><span class="op">)</span>;</span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"warn"</span><span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>;</span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      ncol<span class="op">=</span><span class="fl">6</span>,</span>
<span class="r-in">      base_size<span class="op">=</span><span class="fl">12</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"raw_counts"</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      ncol<span class="op">=</span><span class="fl">6</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"counts"</span>,</span>
<span class="r-in">      useRank<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span class="r-in">      ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">11000</span>, <span class="fl">11000</span><span class="op">)</span>,</span>
<span class="r-in">      maintitle<span class="op">=</span><span class="st">"MA-plots by rank and rank difference"</span>,</span>
<span class="r-in">      titleBoxColor<span class="op">=</span><span class="va">titleBoxColor</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      ncol<span class="op">=</span><span class="fl">6</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"counts"</span>,</span>
<span class="r-in">      titleBoxColor<span class="op">=</span><span class="va">titleBoxColor</span>,</span>
<span class="r-in">      base_size<span class="op">=</span><span class="fl">10</span>,</span>
<span class="r-in">      maintitle<span class="op">=</span><span class="st">"MA-plots showing MAD factor"</span>,</span>
<span class="r-in">      displayMAD<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      ncol<span class="op">=</span><span class="fl">6</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"counts"</span>,</span>
<span class="r-in">      titleBoxColor<span class="op">=</span><span class="va">titleBoxColor</span>,</span>
<span class="r-in">      maintitle<span class="op">=</span><span class="st">"MA-plot omitting one panel, then using blankPlotPos"</span>,</span>
<span class="r-in">      whichSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">GeneSE</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">21</span>, <span class="fl">23</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">]</span>,</span>
<span class="r-in">      blankPlotPos<span class="op">=</span><span class="fl">22</span>,</span>
<span class="r-in">      displayMAD<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">   <span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">   <span class="va">ggdf</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"counts"</span>,</span>
<span class="r-in">      whichSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span>
<span class="r-in">      return_type<span class="op">=</span><span class="st">"data"</span>,</span>
<span class="r-in">      titleBoxColor<span class="op">=</span><span class="va">titleBoxColor</span><span class="op">)</span></span>
<span class="r-in">   <span class="va">highlightPoints1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/tcount.html" class="external-link">tcount</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ggdf</span>, <span class="va">mean</span> <span class="op">&gt;</span> <span class="fl">15</span> <span class="op">&amp;</span> <span class="va">difference</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">item</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in">   <span class="va">highlightPoints2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">ggdf</span>, <span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"CA1CB492"</span> <span class="op">&amp;</span></span>
<span class="r-in">      <span class="va">difference</span> <span class="op">&lt;</span> <span class="op">-</span><span class="fl">4.5</span><span class="op">)</span><span class="op">$</span><span class="va">item</span>;</span>
<span class="r-in">   <span class="va">highlightPoints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span class="r-in">      divergent<span class="op">=</span><span class="va">highlightPoints1</span>,</span>
<span class="r-in">      low_CA1CB492<span class="op">=</span><span class="va">highlightPoints2</span><span class="op">)</span>;</span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">ggdf_h</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"counts"</span>,</span>
<span class="r-in">      highlightPoints<span class="op">=</span><span class="va">highlightPoints</span>,</span>
<span class="r-in">      whichSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,</span>
<span class="r-in">      return_type<span class="op">=</span><span class="st">"data"</span>,</span>
<span class="r-in">      titleBoxColor<span class="op">=</span><span class="va">titleBoxColor</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in">   <span class="co"># you can use output from `jammaplot()` as input to `ggjammaplot()`:</span></span>
<span class="r-in">   <span class="va">jp2</span> <span class="op">&lt;-</span> <span class="fu">jammaplot</span><span class="op">(</span><span class="va">GeneSE</span>,</span>
<span class="r-in">      outlierMAD<span class="op">=</span><span class="fl">2</span>,</span>
<span class="r-in">      doPlot<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span class="r-in">      assay_name<span class="op">=</span><span class="st">"raw_counts"</span>,</span>
<span class="r-in">      filterFloor<span class="op">=</span><span class="fl">1e-10</span>,</span>
<span class="r-in">      filterFloorReplacement<span class="op">=</span><span class="cn">NA</span>,</span>
<span class="r-in">      centerGroups<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">GeneSE</span><span class="op">)</span><span class="op">$</span><span class="va">Compartment</span>,</span>
<span class="r-in">      subtitleBoxColor<span class="op">=</span><span class="fu">farrisdata</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/farrisdata/man/colorSub.html" class="external-link">colorSub</a></span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">GeneSE</span><span class="op">)</span><span class="op">$</span><span class="va">Compartment</span><span class="op">)</span><span class="op">]</span>,</span>
<span class="r-in">      useRank<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>;</span>
<span class="r-in"></span>
<span class="r-in">   <span class="va">gg1</span> <span class="op">&lt;-</span> <span class="fu">ggjammaplot</span><span class="op">(</span><span class="va">jp2</span>,</span>
<span class="r-in">      ncol<span class="op">=</span><span class="fl">6</span>,</span>
<span class="r-in">      titleBoxColor<span class="op">=</span><span class="va">titleBoxColor</span><span class="op">)</span>;</span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gg1</span><span class="op">)</span>;</span>
<span class="r-in">   <span class="op">}</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘SummarizedExperiment’ was built under R version 3.6.2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘S4Vectors’ was built under R version 3.6.3</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘IRanges’ was built under R version 3.6.2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘GenomeInfoDb’ was built under R version 3.6.3</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘DelayedArray’ was built under R version 3.6.3</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘matrixStats’ was built under R version 3.6.2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>package ‘BiocParallel’ was built under R version 3.6.2</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown parameters: stat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 534 rows containing non-finite values (stat_density2d).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 7776 rows containing missing values (geom_raster).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown parameters: stat</span>
<span class="r-plt img"><img src="jammaplot-1.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 140 rows containing non-finite values (stat_density2d).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 7776 rows containing missing values (geom_raster).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown parameters: stat</span>
<span class="r-plt img"><img src="jammaplot-2.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 322 rows containing non-finite values (stat_density2d).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 7776 rows containing missing values (geom_raster).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring unknown parameters: stat</span>
<span class="r-plt img"><img src="jammaplot-3.png" alt="" width="700" height="433"></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 317 rows containing non-finite values (stat_density2d).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 7636 rows containing missing values (geom_raster).</span>
<span class="r-plt img"><img src="jammaplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Note the example data requires the affydata Bioconductor package</span></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">affydata</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Dilution</span><span class="op">)</span>;</span>
<span class="r-in">   <span class="va">edata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log2</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/pkg/Biobase/man/exprs.html" class="external-link">exprs</a></span><span class="op">(</span><span class="va">Dilution</span><span class="op">)</span><span class="op">)</span>;</span>
<span class="r-in">   <span class="fu">jammaplot</span><span class="op">(</span><span class="va">edata</span><span class="op">)</span>;</span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-plt img"><img src="jammaplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.9000.9000.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

